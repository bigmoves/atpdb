{
  "annotations": {
    "list": []
  },
  "editable": true,
  "fiscalYearStartMonth": 0,
  "graphTooltip": 0,
  "id": null,
  "links": [],
  "liveNow": false,
  "panels": [
    {
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 0 },
      "id": 1,
      "fieldConfig": { "defaults": { "unit": "reqps" } },
      "options": { "colorMode": "value", "graphMode": "area", "justifyMode": "auto", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        {
          "expr": "sum(rate(http_requests_total{path=\"/query\"}[5m]))",
          "legendFormat": "req/s"
        }
      ],
      "title": "Query Rate",
      "type": "stat"
    },
    {
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 0 },
      "id": 2,
      "fieldConfig": {
        "defaults": {
          "mappings": [
            { "options": { "0": { "text": "Disconnected", "color": "red" }, "1": { "text": "Connected", "color": "green" } }, "type": "value" }
          ]
        }
      },
      "options": { "colorMode": "value", "graphMode": "none", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        { "expr": "firehose_connected", "legendFormat": "status" }
      ],
      "title": "Firehose",
      "type": "stat"
    },
    {
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 0 },
      "id": 3,
      "fieldConfig": { "defaults": { "unit": "short", "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }] } } },
      "options": { "colorMode": "value", "graphMode": "area", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        { "expr": "storage_records_total", "legendFormat": "records" }
      ],
      "title": "Records",
      "type": "stat"
    },
    {
      "gridPos": { "h": 4, "w": 4, "x": 12, "y": 0 },
      "id": 4,
      "fieldConfig": { "defaults": { "unit": "short", "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }] } } },
      "options": { "colorMode": "value", "graphMode": "area", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        { "expr": "storage_collections_total", "legendFormat": "collections" }
      ],
      "title": "Collections",
      "type": "stat"
    },
    {
      "gridPos": { "h": 4, "w": 4, "x": 16, "y": 0 },
      "id": 12,
      "fieldConfig": { "defaults": { "unit": "bytes", "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }] } } },
      "options": { "colorMode": "value", "graphMode": "area", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        { "expr": "storage_disk_bytes", "legendFormat": "size" }
      ],
      "title": "DB Size",
      "type": "stat"
    },
    {
      "gridPos": { "h": 4, "w": 4, "x": 20, "y": 0 },
      "id": 13,
      "fieldConfig": { "defaults": { "unit": "bytes", "thresholds": { "mode": "absolute", "steps": [{ "color": "blue", "value": null }] } } },
      "options": { "colorMode": "value", "graphMode": "area", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        { "expr": "search_disk_bytes", "legendFormat": "size" }
      ],
      "title": "Search Size",
      "type": "stat"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 4 },
      "id": 5,
      "fieldConfig": { "defaults": { "unit": "s" } },
      "targets": [
        { "expr": "histogram_quantile(0.50, sum(rate(http_request_duration_seconds_bucket{path=\"/query\"}[5m])) by (le))", "legendFormat": "p50" },
        { "expr": "histogram_quantile(0.95, sum(rate(http_request_duration_seconds_bucket{path=\"/query\"}[5m])) by (le))", "legendFormat": "p95" },
        { "expr": "histogram_quantile(0.99, sum(rate(http_request_duration_seconds_bucket{path=\"/query\"}[5m])) by (le))", "legendFormat": "p99" }
      ],
      "title": "Query Latency",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 4 },
      "id": 6,
      "targets": [
        { "expr": "sum by (status) (rate(http_requests_total{path=\"/query\"}[5m]))", "legendFormat": "{{status}}" }
      ],
      "title": "Query Requests by Status",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 12 },
      "id": 8,
      "targets": [
        { "expr": "sum by (op) (rate(firehose_operations_total[1m]))", "legendFormat": "{{op}}" }
      ],
      "title": "Firehose Operations/sec",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 12 },
      "id": 9,
      "targets": [
        { "expr": "firehose_last_seq", "legendFormat": "sequence" }
      ],
      "title": "Firehose Sequence",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 20 },
      "id": 10,
      "fieldConfig": { "defaults": { "unit": "s" } },
      "targets": [
        { "expr": "histogram_quantile(0.95, sum(rate(storage_operation_seconds_bucket[5m])) by (le, op))", "legendFormat": "{{op}}" }
      ],
      "title": "Storage Latency p95",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 20 },
      "id": 11,
      "targets": [
        { "expr": "storage_repos_total", "legendFormat": "{{status}}" }
      ],
      "title": "Repos by Status",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 4, "w": 4, "x": 0, "y": 28 },
      "id": 14,
      "fieldConfig": { "defaults": { "unit": "percentunit", "min": 0, "max": 1, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.7 }, { "color": "red", "value": 0.9 }] } } },
      "options": { "colorMode": "value", "graphMode": "area", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        { "expr": "1 - (node_memory_MemAvailable_bytes / node_memory_MemTotal_bytes)", "legendFormat": "used" }
      ],
      "title": "Memory",
      "type": "stat"
    },
    {
      "gridPos": { "h": 4, "w": 4, "x": 4, "y": 28 },
      "id": 15,
      "fieldConfig": { "defaults": { "unit": "percentunit", "min": 0, "max": 1, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.7 }, { "color": "red", "value": 0.9 }] } } },
      "options": { "colorMode": "value", "graphMode": "area", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        { "expr": "1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[1m]))", "legendFormat": "used" }
      ],
      "title": "CPU",
      "type": "stat"
    },
    {
      "gridPos": { "h": 4, "w": 4, "x": 8, "y": 28 },
      "id": 16,
      "fieldConfig": { "defaults": { "unit": "percentunit", "min": 0, "max": 1, "thresholds": { "mode": "absolute", "steps": [{ "color": "green", "value": null }, { "color": "yellow", "value": 0.7 }, { "color": "red", "value": 0.9 }] } } },
      "options": { "colorMode": "value", "graphMode": "area", "reduceOptions": { "calcs": ["lastNotNull"] } },
      "targets": [
        { "expr": "1 - (node_filesystem_avail_bytes{mountpoint=\"/\"} / node_filesystem_size_bytes{mountpoint=\"/\"})", "legendFormat": "used" }
      ],
      "title": "Disk",
      "type": "stat"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 0, "y": 32 },
      "id": 17,
      "fieldConfig": { "defaults": { "unit": "bytes" } },
      "targets": [
        { "expr": "node_memory_MemTotal_bytes", "legendFormat": "total" },
        { "expr": "node_memory_MemTotal_bytes - node_memory_MemAvailable_bytes", "legendFormat": "used" }
      ],
      "title": "Memory Usage",
      "type": "timeseries"
    },
    {
      "gridPos": { "h": 8, "w": 12, "x": 12, "y": 32 },
      "id": 18,
      "fieldConfig": { "defaults": { "unit": "percentunit", "min": 0, "max": 1 } },
      "targets": [
        { "expr": "1 - avg(rate(node_cpu_seconds_total{mode=\"idle\"}[1m]))", "legendFormat": "CPU usage" }
      ],
      "title": "CPU Usage",
      "type": "timeseries"
    }
  ],
  "refresh": "10s",
  "schemaVersion": 38,
  "style": "dark",
  "tags": ["atpdb"],
  "templating": { "list": [] },
  "time": { "from": "now-15m", "to": "now" },
  "timepicker": {},
  "timezone": "",
  "title": "ATPDB Overview",
  "uid": "atpdb-overview",
  "version": 2
}
